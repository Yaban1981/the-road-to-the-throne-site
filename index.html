<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QHC — The Road to The Throne</title>
  <meta name="description" content="Intérêt tournois printemps 2026 — Boston, Montreal Meltdown, The Throne" />
  <link rel="icon" href="https://yaban1981.github.io/the-road-to-the-throne-site/logos/qhc.png">
  <meta name="theme-color" content="#0a1020">
  <meta name="format-detection" content="telephone=no">

  <style>
    :root{
      --bg:#0f172a; --panel:#0e152a; --panel2:#0a1020;
      --text:#e7ecf3; --muted:#a7b3c7;
      --accent:#d4af37; --accent2:#3b82f6;
      --success:#d4af37; --ring:rgba(59,130,246,.3);
      --radius:16px;
    }
    *{box-sizing:border-box; -webkit-tap-highlight-color:transparent}
    html,body{scroll-behavior:smooth; -webkit-text-size-adjust:100%}
    body{
      margin:0; font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;
      background: radial-gradient(800px 400px at 10% -10%, #0b2451 0%, transparent 60%), linear-gradient(180deg, #091024, #0a0f1a);
      color:var(--text); line-height:1.5;
    }
    /* Hero */
    .hero{padding:28px 16px 18px; background:
      radial-gradient(700px 320px at 15% -10%, rgba(59,130,246,.18), transparent 60%),
      linear-gradient(180deg, #0a1020, #0b1222 60%, #0a0f1a);
      border-bottom:1px solid rgba(255,255,255,.06);
    }
    .hero-wrap{max-width:980px; margin:0 auto; display:flex; flex-direction:column; align-items:center; gap:18px}
    .hero-logo{width:120px; height:120px; border-radius:22px; display:grid; place-items:center; overflow:hidden;
      background: radial-gradient(closest-side, rgba(59,130,246,.30), transparent 68%); box-shadow:0 16px 44px rgba(3,102,214,.35)}
    .hero-logo img{width:100%; height:100%; object-fit:cover; border-radius:20px}
    .hero h1{margin:0; font-size:2rem}
    .hero-sub{margin:6px 0 4px; color:#dfe7ff; font-size:1.1rem}
    .muted{color:var(--muted)}
    /* Layout */
    main{padding:12px 16px 40px; max-width:1040px; margin:0 auto}
    .card, form{background:linear-gradient(180deg,var(--panel2),var(--panel)); border-radius:var(--radius);
      border:1px solid rgba(255,255,255,.06); padding:20px; margin:12px 0}
    fieldset{border:2px solid rgba(212,175,94,.35); padding:18px; border-radius:14px; margin:16px 0 0; position:relative}
    fieldset.completed::after{content:"✓"; position:absolute; top:-12px; right:15px; width:24px; height:24px; border-radius:50%;
      background:var(--success); color:#0a0f1a; display:flex; align-items:center; justify-content:center; font-weight:800}
    label{display:block; font-size:1rem; margin-bottom:8px; font-weight:500}
    .grid{display:flex; flex-direction:column; gap:16px}
    .input-container{position:relative}
    .input-container.valid::after{content:"✓"; position:absolute; right:14px; top:50%; transform:translateY(-50%); color:var(--success); font-weight:800}

    input[type="text"], input[type="email"], input[type="tel"], input[type="range"], select, textarea{
      width:100%; padding:16px; border-radius:12px; border:1.5px solid rgba(255,255,255,.16);
      background:#0b1020; color:var(--text); font-size:16px;
    }
    input:focus, select:focus, textarea:focus{border-color:var(--accent2); box-shadow:0 0 0 3px var(--ring); background:#0b142a}

    /* Radios/checkbox : pas de point bleu natif + encadré jaune cohérent */
    .check-row{display:flex; flex-direction:column; gap:10px}
    .check{position:relative; display:flex; align-items:center; gap:10px; padding:14px 44px 14px 48px;
      border:1px solid rgba(255,255,255,.08); border-radius:12px; background:#0b1020; min-height:54px}
    .check input{position:absolute; inset:0; margin:0; opacity:0; cursor:pointer}
    .check::before{content:""; position:absolute; left:14px; top:50%; transform:translateY(-50%);
      width:18px; height:18px; border-radius:50%; border:2px solid #cfd8e3; background:transparent}
    /* Style quand coché — moderne */
    .check:has(input:checked){ border-color:var(--accent); background:rgba(212,175,94,.08) }
    .check:has(input:checked)::before{ background:var(--accent2); border-color:#fff }
    .check:has(input:checked)::after{ content:"✓"; position:absolute; right:14px; top:50%; transform:translateY(-50%); color:var(--accent); font-weight:800 }
    /* Fallback ancien iOS/Android (JS ajoute .selected) */
    .check.selected{ border-color:var(--accent); background:rgba(212,175,94,.08) }
    .check.selected::before{ background:var(--accent2); border-color:#fff }
    .check.selected::after{ content:"✓"; position:absolute; right:14px; top:50%; transform:translateY(-50%); color:var(--accent); font-weight:800 }

    .submit{margin-top:24px; display:flex; gap:12px; flex-direction:column}
    button{appearance:none; border:0; background:linear-gradient(135deg, var(--accent), var(--accent2)); color:#fff; padding:18px 24px; border-radius:14px; font-weight:700; font-size:1.1rem; min-height:56px; cursor:pointer}
    @media (min-width:768px){ .check-row{flex-direction:row; flex-wrap:wrap} .submit{flex-direction:row} }
  </style>
</head>
<body>
  <header class="hero">
    <div class="hero-wrap">
      <div class="hero-logo"><img src="https://yaban1981.github.io/the-road-to-the-throne-site/logos/qhc.png" alt="Logo Québec HC"></div>
      <div class="hero-text">
        <h1>The Road to The Throne</h1>
        <p class="hero-sub">Intérêt tournois printemps 2026</p>
        <p class="muted">Confiance requise ≥ 80% • Confidence required ≥ 80%</p>
      </div>
    </div>
  </header>

  <main>
    <div class="card">
      <h3>FR — Important</h3>
      <p>Ce formulaire sert à former les <strong>alignements par tournoi</strong>.</p>
      <p><strong>Règle The Throne</strong> : participation à au moins <strong>un</strong> autre tournoi (Boston ou Meltdown).</p>
      <p><strong>Places limitées</strong> : notre staff formera les <strong>meilleurs trios/duos</strong>.</p>
      <p class="muted">Frais d'assurances et décharges à prévoir.</p>
    </div>

    <!-- ========= FORMULAIRE : POST natif vers Apps Script ========= -->
    <form
      action="https://script.google.com/macros/s/AKfycbwo_M5-za4xlXblsb-9yJ8it_izYLFZnS8p42zERudF3Jwbk4f5exUN_xYsnggdpmJHOg/exec"
      method="POST"
      id="qhc-form"
      onsubmit="return businessOk()"
      novalidate>

      <!-- le serveur lira _next pour la redirection après envoi -->
      <input type="hidden" name="_next" value="https://yaban1981.github.io/the-road-to-the-throne-site/thanks.html">
      <!-- alias pour Reply-To côté serveur -->
      <input type="hidden" id="emailAlias" name="email" value="">

      <!-- 1) Joueur -->
      <fieldset id="fieldset-player">
        <legend>1) Info joueur / Player Info</legend>
        <div class="grid">
          <div class="input-container">
            <label for="player_name">Nom complet / Full name <span class="req">*</span></label>
            <input id="player_name" name="player_name" type="text" required autocomplete="name">
          </div>
          <div class="input-container">
            <label for="birth_year">Année / Year <span class="req">*</span></label>
            <select id="birth_year" name="birth_year" required>
              <option value="">— Choisir / Select —</option>
              <option>2012</option><option>2013</option><option>2014</option><option>2015</option>
            </select>
          </div>
          <div class="input-container">
            <label for="city">Ville / City <span class="req">*</span></label>
            <input id="city" name="city" type="text" required>
          </div>
          <div class="input-container">
            <label for="current_team">Équipe actuelle / Current team</label>
            <input id="current_team" name="current_team" type="text">
          </div>
          <div class="input-container">
            <label for="parent_email">Courriel parent / Parent email <span class="req">*</span></label>
            <input id="parent_email" name="parent_email" type="email" required autocomplete="email" inputmode="email">
          </div>
          <div class="input-container">
            <label for="parent_phone">Téléphone parent / Parent phone</label>
            <input id="parent_phone" name="parent_phone" type="tel" autocomplete="tel">
          </div>
        </div>
      </fieldset>

      <!-- 2) Poste & style -->
      <fieldset id="fieldset-position">
        <legend>2) Poste & style / Position & Style</legend>
        <div class="grid">
          <div>
            <label>Position principale / Primary position <span class="req">*</span></label>
            <div class="check-row" aria-label="Primary position">
              <label class="check"><input type="radio" name="primary_position" value="Forward" required> Avant / Forward</label>
              <label class="check"><input type="radio" name="primary_position" value="Defence" required> Défense / Defence</label>
              <label class="check"><input type="radio" name="primary_position" value="Center" required> Centre / Center</label>
              <label class="check"><input type="radio" name="primary_position" value="Goaler" required> Gardien / Goaler</label>
            </div>
          </div>

          <div>
            <label>Position secondaire / Secondary position</label>
            <div class="check-row" aria-label="Secondary position">
              <label class="check"><input type="radio" name="secondary_position" value="Forward"> Avant / Forward</label>
              <label class="check"><input type="radio" name="secondary_position" value="Defence"> Défense / Defence</label>
              <label class="check"><input type="radio" name="secondary_position" value="Center"> Centre / Center</label>
              <label class="check"><input type="radio" name="secondary_position" value="Goaler"> Gardien / Goaler</label>
              <label class="check"><input type="radio" name="secondary_position" value="None" checked> Aucune / None</label>
            </div>
          </div>

          <div>
            <label>Côté / Side <span class="req">*</span></label>
            <div class="check-row" aria-label="Side (L/R)">
              <label class="check"><input type="checkbox" name="side_right" value="Yes"> Droite / Right</label>
              <label class="check"><input type="checkbox" name="side_left"  value="Yes"> Gauche / Left</label>
            </div>
          </div>

          <div class="input-container">
            <label for="player_style">Style de joueur / Player style</label>
            <input id="player_style" name="player_style" type="text" placeholder="ex: rapide/fast, offensif/offensive, physique/physical…">
          </div>
          <div class="input-container">
            <label for="video_links">Liens vidéo / Video links</label>
            <textarea id="video_links" name="video_links" placeholder="Liens YouTube/Vimeo, timestamps, notes (multi‑lignes)…"></textarea>
          </div>
        </div>
      </fieldset>

      <!-- 3) Chandail -->
      <fieldset id="fieldset-jersey">
        <legend>3) Chandail / Jersey</legend>
        <div class="grid">
          <div class="input-container">
            <label for="jersey_number_1">Choix #1</label>
            <input id="jersey_number_1" name="jersey_number_1" type="text" inputmode="numeric" pattern="[0-9]{1,2}" placeholder="ex: 27">
          </div>
          <div class="input-container">
            <label for="jersey_number_2">Choix #2</label>
            <input id="jersey_number_2" name="jersey_number_2" type="text" inputmode="numeric" pattern="[0-9]{1,2}" placeholder="ex: 88">
          </div>
          <div class="input-container">
            <label for="jersey_number_3">Choix #3</label>
            <input id="jersey_number_3" name="jersey_number_3" type="text" inputmode="numeric" pattern="[0-9]{1,2}" placeholder="ex: 13">
          </div>

          <div>
            <label>Type</label>
            <div class="check-row" aria-label="Jersey type">
              <label class="check"><input type="radio" name="jersey_type" value="Loaned" checked> Prêté / Loaned</label>
              <label class="check"><input type="radio" name="jersey_type" value="Customized"> Personnalisé / Custom</label>
            </div>
            <div class="muted" style="margin-top:8px">
              <strong>Note / Note:</strong> des frais <u>supplémentaires</u> s’appliquent pour un chandail <strong>personnalisé</strong> (nom & numéro).
            </div>
          </div>

          <div class="input-container">
            <label for="jersey_size">Taille / Size <span class="req">*</span></label>
            <select id="jersey_size" name="jersey_size" required>
              <option value="">— Choisir / Select —</option>
              <option>YS</option><option>YM</option><option>YL</option>
              <option>AS</option><option>AM</option><option>AL</option><option>AXL</option>
            </select>
          </div>
        </div>
      </fieldset>

      <!-- 4) Disponibilités -->
      <fieldset id="fieldset-availability">
        <legend>4) Disponibilités / Availability</legend>
        <div class="grid">
          <div class="muted">Aucun paiement maintenant / No payment now.</div>

          <div>
            <label class="muted">Boston, MA — ≈ 150 $ CAD • 15–17.05.2026</label>
            <div class="check-row" aria-label="Boston">
              <label class="check"><input type="radio" name="boston_showdown" value="Yes"> Oui / Yes</label>
              <label class="check"><input type="radio" name="boston_showdown" value="No"> Non / No</label>
              <label class="check"><input type="radio" name="boston_showdown" value="TBD" checked> À confirmer / TBD</label>
            </div>
          </div>

          <div>
            <label class="muted">Montréal, QC — ≈ 150 $ CAD • 05–07.06.2026</label>
            <div class="check-row" aria-label="Meltdown">
              <label class="check"><input type="radio" name="montreal_meltdown" value="Yes"> Oui / Yes</label>
              <label class="check"><input type="radio" name="montreal_meltdown" value="No"> Non / No</label>
              <label class="check"><input type="radio" name="montreal_meltdown" value="TBD" checked> À confirmer / TBD</label>
            </div>
          </div>

          <div>
            <label class="muted">Toronto, ON — ≈ 250 $ CAD • 24–26.07.2026</label>
            <div class="check-row" aria-label="The Throne">
              <label class="check"><input type="radio" name="the_throne" value="Yes"> Oui / Yes</label>
              <label class="check"><input type="radio" name="the_throne" value="No"> Non / No</label>
              <label class="check"><input type="radio" name="the_throne" value="TBD" checked> À confirmer / TBD</label>
            </div>
          </div>

          <div class="input-container">
            <label for="confidence_pct">Confiance / Confidence (≥ 80%)</label>
            <input type="range" id="confidence_pct" name="confidence_pct" min="80" max="100" value="80"
                   oninput="document.getElementById('confVal').textContent=this.value+'%';">
            <div class="muted">Valeur / Value : <strong id="confVal">80%</strong></div>
          </div>
        </div>
      </fieldset>

      <!-- 5) Confirmations -->
      <fieldset id="fieldset-confirmations">
        <legend>5) Confirmations</legend>
        <div class="grid">
          <label class="check"><input type="checkbox" name="ack_throne_rule" required> Je comprends la règle The Throne / I understand the Throne rule <span class="req">*</span></label>
          <label class="check"><input type="checkbox" name="ack_limited_spots" required> Places limitées / Limited spots <span class="req">*</span></label>
          <label class="check"><input type="checkbox" name="consent_contact" required> J'accepte d'être contacté / I agree to be contacted <span class="req">*</span></label>
        </div>
      </fieldset>

      <div class="submit">
        <button type="reset" class="outline">Effacer / Clear</button>
        <button type="submit" id="submitBtn">Soumettre / Submit</button>
      </div>
    </form>
  </main>

  <script>
    // Synchronise l’alias pour Reply‑To côté serveur
    (function(){
      const parentEmail = document.getElementById('parent_email');
      const emailAlias  = document.getElementById('emailAlias');
      function syncEmail(){ emailAlias.value = (parentEmail?.value || '').trim(); }
      parentEmail?.addEventListener('input', syncEmail); syncEmail();
    })();

    // Visuel: valid/complété + fallback pour anciens navigateurs (classe .selected)
    (function(){
      const form = document.getElementById('qhc-form');

      // Entrées texte/select/textarea
      form.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], textarea, select')
      .forEach(el=>{
        el.addEventListener('input', ()=>{
          const wrap = el.closest('.input-container');
          if(wrap){
            const filled = (el.tagName==='SELECT') ? el.value!=='' : el.value.trim()!=='';
            wrap.classList.toggle('valid', filled);
            el.classList.toggle('valid', filled);
          }
          mark(el.closest('fieldset'));
        });
      });

      // Radios/checkbox: fallback .selected si :has() pas dispo
      form.addEventListener('change', (e)=>{
        const t=e.target;
        if(t.type==='radio'){
          form.querySelectorAll('input[name="'+t.name+'"]').forEach(r=>r.closest('.check')?.classList.remove('selected'));
          t.closest('.check')?.classList.add('selected');
          mark(t.closest('fieldset'));
        } else if(t.type==='checkbox'){
          t.closest('.check')?.classList.toggle('selected', t.checked);
          mark(t.closest('fieldset'));
        }
      });

      function mark(fs){
        if(!fs) return; let ok=false;
        switch(fs.id){
          case 'fieldset-player': {
            const need=['player_name','birth_year','city','parent_email'];
            ok = need.every(id=>{
              const el=document.getElementById(id);
              return el && (el.tagName==='SELECT' ? el.value!=='' : el.value.trim()!=='') && (el.id!=='parent_email' || el.checkValidity());
            }); break;
          }
          case 'fieldset-position': {
            const primary=!!fs.querySelector('input[name="primary_position"]:checked');
            const sideOK =fs.querySelector('[name="side_right"]').checked || fs.querySelector('[name="side_left"]').checked;
            ok=primary && sideOK; break;
          }
          case 'fieldset-jersey': {
            const typeOK=!!fs.querySelector('input[name="jersey_type"]:checked');
            const sizeOK=(document.getElementById('jersey_size').value!=='');
            ok=typeOK && sizeOK; break;
          }
          case 'fieldset-availability': {
            const b=!!fs.querySelector('input[name="boston_showdown"]:checked');
            const m=!!fs.querySelector('input[name="montreal_meltdown"]:checked');
            const t=!!fs.querySelector('input[name="the_throne"]:checked');
            const conf=parseInt(document.getElementById('confidence_pct').value,10) >= 80;
            ok=b && m && t && conf; break;
          }
          case 'fieldset-confirmations': {
            const c1=fs.querySelector('[name="ack_throne_rule"]').checked;
            const c2=fs.querySelector('[name="ack_limited_spots"]').checked;
            const c3=fs.querySelector('[name="consent_contact"]').checked;
            ok=c1 && c2 && c3; break;
          }
        }
        fs.classList.toggle('completed', ok);
      }

      // Amorçage visuel
      form.querySelectorAll('input,select,textarea').forEach(el=>{
        if(el.type==='range') return;
        const evt=(el.type==='radio'||el.type==='checkbox')?'change':'input';
        el.dispatchEvent(new Event(evt));
      });
    })();

    // Règles métier AVANT envoi (POST natif)
    function businessOk(){
      const form=document.getElementById('qhc-form');
      if(!form.checkValidity()){ form.reportValidity(); return false; }
      const right=form.querySelector('[name="side_right"]').checked;
      const left =form.querySelector('[name="side_left"]').checked;
      if(!right && !left){ alert('Sélectionnez au moins un côté (Droit/Gauche). / Select at least one side.'); return false; }
      const T=form.querySelector('input[name="the_throne"]:checked')?.value||'TBD';
      const B=form.querySelector('input[name="boston_showdown"]:checked')?.value||'TBD';
      const M=form.querySelector('input[name="montreal_meltdown"]:checked')?.value||'TBD';
      if(T==='Yes' && !(B==='Yes' || M==='Yes')){ alert("The Throne : cochez 'Oui' à Boston OU Meltdown."); return false; }
      const conf=parseInt(document.getElementById('confidence_pct').value,10);
      if(isNaN(conf)||conf<80){ alert('Confiance ≥ 80 % / Confidence ≥ 80%.'); return false; }
      // ✅ OK : on laisse le navigateur POSTer vers Apps Script
      // Le serveur enverra l’e‑mail puis redirigera vers /thanks.html
      return true;
    }
  </script>
</body>
</html>
